<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAIN AGM AMACH Salary Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 30px;
            font-size: 28px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .month-section {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #e2e8f0;
        }

        .month-section h2 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .month-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 5px;
            font-size: 14px;
        }

        input, select {
            padding: 10px;
            border: 2px solid #cbd5e0;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .staff-section {
            margin-bottom: 30px;
        }

        .staff-form {
            background: #edf2f7;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #cbd5e0;
        }

        .staff-form h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .calculated-values {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .calc-item {
            font-size: 13px;
            color: #4a5568;
        }

        .calc-item strong {
            color: #2d3748;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-add {
            background: #48bb78;
            color: white;
        }

        .btn-add:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
        }

        .btn-download {
            background: #667eea;
            color: white;
            width: 100%;
            margin-top: 20px;
        }

        .btn-download:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-remove {
            background: #f56565;
            color: white;
            padding: 8px 15px;
            font-size: 12px;
            margin-left: 5px;
        }

        .btn-remove:hover {
            background: #e53e3e;
        }

        .btn-edit {
            background: #ed8936;
            color: white;
            padding: 8px 15px;
            font-size: 12px;
        }

        .btn-edit:hover {
            background: #dd6b20;
        }

        .staff-table {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            font-size: 13px;
            color: #4a5568;
        }

        tr:hover {
            background: #f7fafc;
        }

        .total-row {
            background: #edf2f7;
            font-weight: 700;
            color: #2d3748;
        }

        input[type="number"] {
            width: 100%;
        }

        .actions {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>JAIN AGM AMACH Salary Calculator Tool</h1>
        
        <div class="month-section">
            <h2>Month Configuration</h2>
            <div class="month-inputs">
                <div class="input-group">
                    <label for="month">Month</label>
                    <input type="month" id="month" required>
                </div>
                <div class="input-group">
                    <label for="workingDays">Working Days</label>
                    <input type="number" id="workingDays" min="1" max="31" required>
                </div>
                <div class="input-group">
                    <label for="sundays">Sundays (Paid)</label>
                    <input type="number" id="sundays" min="0" max="5" value="0">
                </div>
                <div class="input-group">
                    <label for="officialHolidays">Official Holidays (Paid)</label>
                    <input type="number" id="officialHolidays" min="0" max="10" value="0">
                </div>
            </div>
        </div>

        <div class="staff-section">
            <div class="staff-form">
                <h3>Add Staff Member</h3>
                <div class="form-grid">
                    <div class="input-group">
                        <label for="staffName">Staff Name</label>
                        <input type="text" id="staffName" required>
                    </div>
                    <div class="input-group">
                        <label for="designation">Designation</label>
                        <select id="designation" required>
                            <option value="">Select</option>
                            <option value="ASST PROF">ASST PROF</option>
                            <option value="ASSO PROF">ASSO PROF</option>
                            <option value="PROF">PROF</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="department">Department</label>
                        <select id="department" required>
                            <option value="">Select</option>
                            <option value="SS">SS</option>
                            <option value="SR">SR</option>
                            <option value="SK">SK</option>
                            <option value="DG">DG</option>
                            <option value="RSBK">RSBK</option>
                            <option value="AT">AT</option>
                            <option value="RN">RN</option>
                            <option value="SW">SW</option>
                            <option value="KC">KC</option>
                            <option value="PK">PK</option>
                            <option value="ST">ST</option>
                            <option value="SKT">SKT</option>
                            <option value="PTSR">PTSR</option>
                            <option value="KB">KB</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="grossSalary">Gross Salary (₹)</label>
                        <input type="number" id="grossSalary" min="0" step="0.01" required>
                    </div>
                    <div class="input-group">
                        <label for="cls">CLs (Paid Days)</label>
                        <input type="number" id="cls" min="0" max="10" value="0">
                    </div>
                    <div class="input-group">
                        <label for="shortfallHours">Shortfall Hours</label>
                        <input type="number" id="shortfallHours" min="0" step="0.5" value="0">
                    </div>
                    <div class="input-group">
                        <label for="esiDeduction">ESI Deduction (₹)</label>
                        <input type="number" id="esiDeduction" min="0" step="0.01" value="0">
                    </div>
                    <div class="input-group">
                        <label for="pfDeduction">PF Deduction (₹)</label>
                        <input type="number" id="pfDeduction" min="0" step="0.01" value="0">
                    </div>
                    <div class="input-group">
                        <label for="ptDeduction">PT Deduction (₹)</label>
                        <input type="number" id="ptDeduction" min="0" step="0.01" value="0">
                    </div>
                </div>
                <div id="calculatedDisplay" class="calculated-values" style="display: none;">
                    <div class="calc-item">Total Working Hours: <strong id="dispTotalHours">0</strong></div>
                    <div class="calc-item">Per Day Salary: <strong id="dispPerDay">₹0</strong></div>
                    <div class="calc-item">Per Hour Salary: <strong id="dispPerHour">₹0</strong></div>
                    <div class="calc-item">Shortfall Deduction: <strong id="dispShortfall">₹0</strong></div>
                    <div class="calc-item">Total Deductions: <strong id="dispTotalDed">₹0</strong></div>
                    <div class="calc-item">Net Salary: <strong id="dispNetSalary">₹0</strong></div>
                </div>
                <button class="btn btn-add" onclick="addStaff()" id="addBtn">Add Staff to List</button>
                <button class="btn btn-add" onclick="updateStaff()" id="updateBtn" style="display:none; background:#ed8936;">Update Staff</button>
                <button class="btn btn-remove" onclick="cancelEdit()" id="cancelBtn" style="display:none; margin-left:10px;">Cancel</button>
            </div>
        </div>

        <div class="staff-table">
            <table id="staffTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Designation</th>
                        <th>Department</th>
                        <th>Gross Salary</th>
                        <th>CLs</th>
                        <th>Total Hours</th>
                        <th>Per Day</th>
                        <th>Per Hour</th>
                        <th>Shortfall Hrs</th>
                        <th>Shortfall Amt</th>
                        <th>ESI</th>
                        <th>PF</th>
                        <th>PT</th>
                        <th>Total Deductions</th>
                        <th>Net Salary</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="staffTableBody">
                </tbody>
            </table>
        </div>

        <button class="btn btn-download" onclick="downloadExcel()">Download Salary Sheet (Excel)</button>
    </div>

    <script>
        let staffList = [];
        let editingIndex = -1;

        // Real-time calculation preview
        document.querySelectorAll('#grossSalary, #shortfallHours, #esiDeduction, #pfDeduction, #ptDeduction').forEach(input => {
            input.addEventListener('input', updateCalculationPreview);
        });

        function updateCalculationPreview() {
            const workingDays = parseInt(document.getElementById('workingDays').value) || 0;
            const sundays = parseInt(document.getElementById('sundays').value) || 0;
            const holidays = parseInt(document.getElementById('officialHolidays').value) || 0;
            const cls = parseInt(document.getElementById('cls').value) || 0;
            const grossSalary = parseFloat(document.getElementById('grossSalary').value) || 0;
            const shortfallHours = parseFloat(document.getElementById('shortfallHours').value) || 0;
            const esi = parseFloat(document.getElementById('esiDeduction').value) || 0;
            const pf = parseFloat(document.getElementById('pfDeduction').value) || 0;
            const pt = parseFloat(document.getElementById('ptDeduction').value) || 0;

            if (grossSalary > 0 && workingDays > 0) {
                const totalPaidDays = workingDays + sundays + holidays + cls;
                const totalWorkingHours = totalPaidDays * 7;
                const perDaySalary = grossSalary / totalPaidDays;
                const perHourSalary = perDaySalary / 7;
                const shortfallDeduction = shortfallHours * perHourSalary;
                const totalDeductions = esi + pf + pt + shortfallDeduction;
                const netSalary = grossSalary - totalDeductions;

                document.getElementById('calculatedDisplay').style.display = 'grid';
                document.getElementById('dispTotalHours').textContent = totalWorkingHours.toFixed(2);
                document.getElementById('dispPerDay').textContent = '₹' + perDaySalary.toFixed(2);
                document.getElementById('dispPerHour').textContent = '₹' + perHourSalary.toFixed(2);
                document.getElementById('dispShortfall').textContent = '₹' + shortfallDeduction.toFixed(2);
                document.getElementById('dispTotalDed').textContent = '₹' + totalDeductions.toFixed(2);
                document.getElementById('dispNetSalary').textContent = '₹' + netSalary.toFixed(2);
            }
        }

        function addStaff() {
            const name = document.getElementById('staffName').value.trim();
            const designation = document.getElementById('designation').value;
            const department = document.getElementById('department').value;
            const grossSalary = parseFloat(document.getElementById('grossSalary').value);
            const cls = parseInt(document.getElementById('cls').value) || 0;
            const shortfallHours = parseFloat(document.getElementById('shortfallHours').value) || 0;
            const esi = parseFloat(document.getElementById('esiDeduction').value) || 0;
            const pf = parseFloat(document.getElementById('pfDeduction').value) || 0;
            const pt = parseFloat(document.getElementById('ptDeduction').value) || 0;

            const workingDays = parseInt(document.getElementById('workingDays').value);
            const sundays = parseInt(document.getElementById('sundays').value) || 0;
            const holidays = parseInt(document.getElementById('officialHolidays').value) || 0;

            if (!name || !designation || !department || !grossSalary || !workingDays) {
                alert('Please fill all required fields including month configuration!');
                return;
            }

            const totalPaidDays = workingDays + sundays + holidays + cls;
            const totalWorkingHours = totalPaidDays * 7;
            const perDaySalary = grossSalary / totalPaidDays;
            const perHourSalary = perDaySalary / 7;
            const shortfallDeduction = shortfallHours * perHourSalary;
            const totalDeductions = esi + pf + pt + shortfallDeduction;
            const netSalary = grossSalary - totalDeductions;

            const staff = {
                name, designation, department, grossSalary, cls,
                totalWorkingHours, perDaySalary, perHourSalary,
                shortfallHours, shortfallDeduction,
                esi, pf, pt, totalDeductions, netSalary
            };

            staffList.push(staff);
            renderTable();
            clearForm();
        }

        function clearForm() {
            document.getElementById('staffName').value = '';
            document.getElementById('designation').value = '';
            document.getElementById('department').value = '';
            document.getElementById('grossSalary').value = '';
            document.getElementById('cls').value = '0';
            document.getElementById('shortfallHours').value = '0';
            document.getElementById('esiDeduction').value = '0';
            document.getElementById('pfDeduction').value = '0';
            document.getElementById('ptDeduction').value = '0';
            document.getElementById('calculatedDisplay').style.display = 'none';
            editingIndex = -1;
            document.getElementById('addBtn').style.display = 'inline-block';
            document.getElementById('updateBtn').style.display = 'none';
            document.getElementById('cancelBtn').style.display = 'none';
        }

        function editStaff(index) {
            editingIndex = index;
            const staff = staffList[index];
            
            document.getElementById('staffName').value = staff.name;
            document.getElementById('designation').value = staff.designation;
            document.getElementById('department').value = staff.department;
            document.getElementById('grossSalary').value = staff.grossSalary;
            document.getElementById('cls').value = staff.cls;
            document.getElementById('shortfallHours').value = staff.shortfallHours;
            document.getElementById('esiDeduction').value = staff.esi;
            document.getElementById('pfDeduction').value = staff.pf;
            document.getElementById('ptDeduction').value = staff.pt;
            
            updateCalculationPreview();
            
            document.getElementById('addBtn').style.display = 'none';
            document.getElementById('updateBtn').style.display = 'inline-block';
            document.getElementById('cancelBtn').style.display = 'inline-block';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateStaff() {
            const name = document.getElementById('staffName').value.trim();
            const designation = document.getElementById('designation').value;
            const department = document.getElementById('department').value;
            const grossSalary = parseFloat(document.getElementById('grossSalary').value);
            const cls = parseInt(document.getElementById('cls').value) || 0;
            const shortfallHours = parseFloat(document.getElementById('shortfallHours').value) || 0;
            const esi = parseFloat(document.getElementById('esiDeduction').value) || 0;
            const pf = parseFloat(document.getElementById('pfDeduction').value) || 0;
            const pt = parseFloat(document.getElementById('ptDeduction').value) || 0;

            const workingDays = parseInt(document.getElementById('workingDays').value);
            const sundays = parseInt(document.getElementById('sundays').value) || 0;
            const holidays = parseInt(document.getElementById('officialHolidays').value) || 0;

            if (!name || !designation || !department || !grossSalary || !workingDays) {
                alert('Please fill all required fields!');
                return;
            }

            const totalPaidDays = workingDays + sundays + holidays + cls;
            const totalWorkingHours = totalPaidDays * 7;
            const perDaySalary = grossSalary / totalPaidDays;
            const perHourSalary = perDaySalary / 7;
            const shortfallDeduction = shortfallHours * perHourSalary;
            const totalDeductions = esi + pf + pt + shortfallDeduction;
            const netSalary = grossSalary - totalDeductions;

            staffList[editingIndex] = {
                name, designation, department, grossSalary, cls,
                totalWorkingHours, perDaySalary, perHourSalary,
                shortfallHours, shortfallDeduction,
                esi, pf, pt, totalDeductions, netSalary
            };

            renderTable();
            clearForm();
        }

        function cancelEdit() {
            clearForm();
        }

        function removeStaff(index) {
            staffList.splice(index, 1);
            renderTable();
        }

        function renderTable() {
            const tbody = document.getElementById('staffTableBody');
            tbody.innerHTML = '';

            staffList.forEach((staff, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${staff.name}</td>
                    <td>${staff.designation}</td>
                    <td>${staff.department}</td>
                    <td>₹${staff.grossSalary.toFixed(2)}</td>
                    <td>${staff.cls}</td>
                    <td>${staff.totalWorkingHours.toFixed(2)}</td>
                    <td>₹${staff.perDaySalary.toFixed(2)}</td>
                    <td>₹${staff.perHourSalary.toFixed(2)}</td>
                    <td>${staff.shortfallHours.toFixed(2)}</td>
                    <td>₹${staff.shortfallDeduction.toFixed(2)}</td>
                    <td>₹${staff.esi.toFixed(2)}</td>
                    <td>₹${staff.pf.toFixed(2)}</td>
                    <td>₹${staff.pt.toFixed(2)}</td>
                    <td>₹${staff.totalDeductions.toFixed(2)}</td>
                    <td>₹${staff.netSalary.toFixed(2)}</td>
                    <td class="actions">
                        <button class="btn btn-edit" onclick="editStaff(${index})">Edit</button>
                        <button class="btn btn-remove" onclick="removeStaff(${index})">Remove</button>
                    </td>
                `;
            });
        }

        function downloadExcel() {
            if (staffList.length === 0) {
                alert('Please add at least one staff member before downloading!');
                return;
            }

            const month = document.getElementById('month').value;
            const workingDays = document.getElementById('workingDays').value;
            const sundays = document.getElementById('sundays').value;
            const holidays = document.getElementById('officialHolidays').value;

            const data = [
                ['JAIN AGM AMACH SALARY SHEET'],
                ['Month:', month],
                ['Working Days:', workingDays],
                ['Sundays (Paid):', sundays],
                ['Official Holidays (Paid):', holidays],
                [],
                ['Name', 'Designation', 'Department', 'Gross Salary', 'CLs', 'Total Working Hours', 
                 'Per Day Salary', 'Per Hour Salary', 'Shortfall Hours', 'Shortfall Amount', 
                 'ESI Deduction', 'PF Deduction', 'PT Deduction', 'Total Deductions', 'Net Salary']
            ];

            staffList.forEach(staff => {
                data.push([
                    staff.name,
                    staff.designation,
                    staff.department,
                    staff.grossSalary.toFixed(2),
                    staff.cls,
                    staff.totalWorkingHours.toFixed(2),
                    staff.perDaySalary.toFixed(2),
                    staff.perHourSalary.toFixed(2),
                    staff.shortfallHours.toFixed(2),
                    staff.shortfallDeduction.toFixed(2),
                    staff.esi.toFixed(2),
                    staff.pf.toFixed(2),
                    staff.pt.toFixed(2),
                    staff.totalDeductions.toFixed(2),
                    staff.netSalary.toFixed(2)
                ]);
            });

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Salary Sheet');

            const fileName = `Salary_Sheet_${month || 'Current'}.xlsx`;
            XLSX.writeFile(wb, fileName);
        }
    </script>
</body>
</html>
