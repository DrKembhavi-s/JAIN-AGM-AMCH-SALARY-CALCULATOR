<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jain AGM AMCH Salary Calculator</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#0b5fff;--muted:#6b7280}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);margin:0;padding:24px;color:#111}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(12,22,39,0.06);margin-bottom:16px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type="number"], input[type="text"], select{width:100%;padding:10px;border:1px solid #e6e9ef;border-radius:8px;font-size:14px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .muted{color:var(--muted);font-size:13px}
    .row{display:flex;gap:12px}
    button{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;font-weight:600;cursor:pointer}
    .secondary{background:#eef2ff;color:var(--accent);border:1px solid rgba(11,95,255,0.12)}
    .result-line{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px dashed #ececf2}
    .big{font-size:18px;font-weight:700}
    .small{font-size:13px;color:var(--muted)}
    footer{font-size:13px;color:var(--muted);text-align:center;margin-top:12px}
    @media (max-width:760px){.grid{grid-template-columns:1fr}.grid-3{grid-template-columns:1fr}}
    .help{font-size:13px;color:#334155;background:#f8fafc;padding:10px;border-radius:8px}
    .staff-list{max-height:160px;overflow:auto;border:1px solid #eef2ff;padding:8px;border-radius:8px}
    .staff-row{display:flex;justify-content:space-between;gap:8px;padding:6px;border-bottom:1px dashed #f1f5f9}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#eef2ff,#e6f0ff);display:flex;align-items:center;justify-content:center;font-weight:700;color:#0b5fff">JAM</div>
      <div>
        <h1>Ayurveda Salary Calculator — September 2025</h1>
        <div class="muted">Single-file web tool: unpaid hours + direct deduction amounts for EPF/ESI + Professional Tax. Save staff profiles for reuse.</div>
      </div>
    </header>

    <div class="card">
      <form id="calcForm" onsubmit="return false;">
        <div class="grid">
          <div>
            <label>Staff name</label>
            <input type="text" id="staffName" placeholder="e.g. Dr. Rahul Sharma">
          </div>
          <div>
            <label>Designation / Dept.</label>
            <input type="text" id="staffDesig" placeholder="e.g. Associate Professor / Kayachikitsa">
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="grid">
          <div>
            <label>College Name</label>
            <input type="text" id="college" value="Jain AGM Ayurvedic Medical College & Hospital, Varur, Karnataka">
          </div>
          <div>
            <label>Month (info)</label>
            <input type="text" id="month" value="September 2025" readonly>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="grid">
          <div>
            <label>Total days in month</label>
            <input type="number" id="totalDays" value="30" min="28" required>
          </div>
          <div>
            <label>Sundays in month</label>
            <input type="number" id="sundays" value="4" min="0" required>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="grid">
          <div>
            <label>Working hours per day</label>
            <input type="number" id="hoursPerDay" value="7" min="1" step="0.1" required>
          </div>
          <div>
            <label>Gross monthly salary (₹)</label>
            <input type="number" id="gross" value="57000" min="0" step="0.01" required>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="grid">
          <div>
            <label>Allowed CLs (days) — paid</label>
            <input type="number" id="clDays" value="2" min="0" step="1">
          </div>
          <div>
            <label>Shortfall hours (unpaid) — in addition to CLs</label>
            <input type="number" id="shortfall" value="15" min="0" step="0.25">
          </div>
        </div>

        <div style="height:14px"></div>

        <div class="grid-3">
          <div>
            <label>EPF — exact amount to deduct (₹)</label>
            <input type="number" id="epfAmount" value="684" min="0" step="0.01">
            <div class="small">Enter the exact employee EPF deduction amount (e.g. ₹684). Leave 0 if not applicable.</div>
          </div>
          <div>
            <label>ESI — exact amount to deduct (₹)</label>
            <input type="number" id="esiAmount" value="100" min="0" step="0.01">
            <div class="small">Enter exact ESI amount. Leave 0 if not applicable.</div>
          </div>
          <div>
            <label>Professional Tax (₹)</label>
            <input type="number" id="profTaxAmt" value="200" min="0" step="0.01">
            <div class="small">Enter fixed PT amount (state-dependent). Default ₹200.</div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button id="calcBtn" onclick="compute()">Calculate Salary</button>
          <button class="secondary" onclick="resetForm()">Reset</button>
          <button class="secondary" onclick="printPayslip()">Print / Save as PDF</button>
          <button class="secondary" onclick="saveStaffProfile()">Save Staff Profile</button>
        </div>

      </form>

      <div style="height:12px"></div>

      <div>
        <label>Saved staff profiles</label>
        <div class="staff-list" id="staffList"></div>
      </div>

    </div>

    <div class="card" id="resultsCard" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div>
          <div class="small">Payslip for</div>
          <div class="big" id="resHeader">Teacher — September 2025</div>
        </div>
        <div class="small">Generated: <span id="genDate"></span></div>
      </div>

      <div class="help">Assumptions: Monthly gross covers Sundays and holidays. Allowed CL days are paid separately. Shortfall hours input is the unpaid hours beyond CL. EPF/ESI are now entered as exact deduction amounts (₹) and applied directly.</div>

      <div style="height:12px"></div>

      <div>
        <div class="result-line"><div class="small">Total days in month</div><div class="small" id="outTotalDays"></div></div>
        <div class="result-line"><div class="small">Sundays (paid)</div><div class="small" id="outSundays"></div></div>
        <div class="result-line"><div class="small">Working days</div><div class="small" id="outWorkingDays"></div></div>
        <div class="result-line"><div class="small">Working hours (monthly)</div><div class="small" id="outWorkingHours"></div></div>
        <div class="result-line"><div class="small">Hourly rate (₹)</div><div class="small" id="outHourlyRate"></div></div>
        <div class="result-line"><div class="small">Allowed CL hours (paid)</div><div class="small" id="outClHours"></div></div>
        <div class="result-line"><div class="small">Shortfall hours (unpaid)</div><div class="small" id="outShortfall"></div></div>
        <div class="result-line"><div class="small">Deduction for unpaid hours (₹)</div><div class="small" id="outUnpaidDeduct"></div></div>

        <div style="height:8px"></div>
        <div class="result-line"><div class="small">Gross salary (₹)</div><div class="small" id="outGross"></div></div>
        <div class="result-line"><div class="small">Subtotal after unpaid-hour deduction (₹)</div><div class="small" id="outSubtotal"></div></div>

        <div style="height:8px"></div>
        <div class="result-line"><div class="small">EPF (₹)</div><div class="small" id="outEPF"></div></div>
        <div class="result-line"><div class="small">ESI (₹)</div><div class="small" id="outESI"></div></div>
        <div class="result-line"><div class="small">Professional Tax (₹)</div><div class="small" id="outPT"></div></div>

        <div style="height:6px"></div>
        <div class="result-line" style="border-bottom:2px solid #eef2ff"><div class="small">Total deductions (₹)</div><div class="small" id="outTotalDeductions"></div></div>

        <div style="height:12px"></div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="small">Net salary to be disbursed</div>
            <div class="big" id="outNet"></div>
          </div>
          <div style="text-align:right" class="small">Rounded: <span id="outRounded"></span></div>
        </div>

      </div>

    </div>

    <footer>Tip: Staff profiles are stored locally in your browser (LocalStorage). They will remain available on the same browser/device unless you clear site data.</footer>
  </div>

<script>
// Utilities
function formatMoney(x){return Number(x).toLocaleString('en-IN',{minimumFractionDigits:2,maximumFractionDigits:2})}

// Staff profile management using localStorage
const STORAGE_KEY = 'ayurveda_salary_staff_profiles_v1';
function loadStaffProfiles(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : [];
  }catch(e){return []}
}
function saveStaffProfiles(list){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
  renderStaffList();
}
function renderStaffList(){
  const container = document.getElementById('staffList');
  const list = loadStaffProfiles();
  container.innerHTML = '';
  if(list.length===0){container.innerHTML = '<div class="small">No saved profiles. Use "Save Staff Profile" to add.</div>'; return}
  list.forEach((s,idx)=>{
    const div = document.createElement('div'); div.className='staff-row';
    div.innerHTML = `<div style="flex:1"><strong>${escapeHtml(s.name||'Unnamed')}</strong><div class="small">${escapeHtml(s.desig||'')}</div></div>
      <div style="width:140px;display:flex;gap:6px;justify-content:flex-end">
        <button class='secondary' onclick='loadProfile(${idx})' style='padding:6px 8px'>Load</button>
        <button class='secondary' onclick='deleteProfile(${idx})' style='padding:6px 8px'>Delete</button>
      </div>`;
    container.appendChild(div);
  });
}
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(c){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c];}); }

function saveStaffProfile(){
  const name = document.getElementById('staffName').value.trim();
  if(!name){alert('Please enter staff name before saving.'); return;}
  const desig = document.getElementById('staffDesig').value.trim();
  const profile = {
    name, desig,
    college: document.getElementById('college').value,
    totalDays: document.getElementById('totalDays').value,
    sundays: document.getElementById('sundays').value,
    hoursPerDay: document.getElementById('hoursPerDay').value,
    gross: document.getElementById('gross').value,
    clDays: document.getElementById('clDays').value,
    shortfall: document.getElementById('shortfall').value,
    epfAmount: document.getElementById('epfAmount').value,
    esiAmount: document.getElementById('esiAmount').value,
    profTaxAmt: document.getElementById('profTaxAmt').value
  };
  const list = loadStaffProfiles();
  list.push(profile);
  saveStaffProfiles(list);
  alert('Profile saved locally. Use Load to prefill next month.');
}
function loadProfile(idx){
  const list = loadStaffProfiles();
  const p = list[idx];
  if(!p) return;
  document.getElementById('staffName').value = p.name||'';
  document.getElementById('staffDesig').value = p.desig||'';
  document.getElementById('college').value = p.college||document.getElementById('college').value;
  document.getElementById('totalDays').value = p.totalDays||document.getElementById('totalDays').value;
  document.getElementById('sundays').value = p.sundays||document.getElementById('sundays').value;
  document.getElementById('hoursPerDay').value = p.hoursPerDay||document.getElementById('hoursPerDay').value;
  document.getElementById('gross').value = p.gross||document.getElementById('gross').value;
  document.getElementById('clDays').value = p.clDays||document.getElementById('clDays').value;
  document.getElementById('shortfall').value = p.shortfall||document.getElementById('shortfall').value;
  document.getElementById('epfAmount').value = p.epfAmount||document.getElementById('epfAmount').value;
  document.getElementById('esiAmount').value = p.esiAmount||document.getElementById('esiAmount').value;
  document.getElementById('profTaxAmt').value = p.profTaxAmt||document.getElementById('profTaxAmt').value;
  alert('Profile loaded into form. Click Calculate to update payslip.');
}
function deleteProfile(idx){
  if(!confirm('Delete this saved profile?')) return;
  const list = loadStaffProfiles(); list.splice(idx,1); saveStaffProfiles(list);
}

// Core computation
function compute(){
  // gather inputs
  const college = document.getElementById('college').value;
  const totalDays = Number(document.getElementById('totalDays').value)||30;
  const sundays = Number(document.getElementById('sundays').value)||0;
  const hoursPerDay = Number(document.getElementById('hoursPerDay').value)||7;
  const gross = Number(document.getElementById('gross').value)||0;
  const clDays = Number(document.getElementById('clDays').value)||0;
  const shortfall = Number(document.getElementById('shortfall').value)||0;
  const epfAmount = Number(document.getElementById('epfAmount').value)||0;
  const esiAmount = Number(document.getElementById('esiAmount').value)||0;
  const profTaxAmt = Number(document.getElementById('profTaxAmt').value)||0;

  // derived
  const workingDays = Math.max(0, totalDays - sundays);
  const totalWorkingHours = workingDays * hoursPerDay;
  const hourlyRate = totalWorkingHours>0 ? gross / totalWorkingHours : 0;

  // CLs paid
  const clHours = clDays * hoursPerDay;
  // unpaid hours = shortfall (as per clarified requirement)
  const unpaidHours = shortfall;
  const unpaidDeduction = unpaidHours * hourlyRate;

  // subtotal after unpaid-hour deduction
  const subtotal = gross - unpaidDeduction;

  // payroll deductions: user-entered amounts (EPF/ESI) applied directly
  const epf = epfAmount;
  const esi = esiAmount;
  const totalDeductions = epf + esi + profTaxAmt;

  const net = subtotal - totalDeductions;

  // populate outputs
  document.getElementById('outTotalDays').innerText = totalDays;
  document.getElementById('outSundays').innerText = sundays;
  document.getElementById('outWorkingDays').innerText = workingDays;
  document.getElementById('outWorkingHours').innerText = totalWorkingHours;
  document.getElementById('outHourlyRate').innerText = formatMoney(hourlyRate);
  document.getElementById('outClHours').innerText = clHours;
  document.getElementById('outShortfall').innerText = unpaidHours;
  document.getElementById('outUnpaidDeduct').innerText = formatMoney(unpaidDeduction);
  document.getElementById('outGross').innerText = formatMoney(gross);
  document.getElementById('outSubtotal').innerText = formatMoney(subtotal);
  document.getElementById('outEPF').innerText = formatMoney(epf);
  document.getElementById('outESI').innerText = formatMoney(esi);
  document.getElementById('outPT').innerText = formatMoney(profTaxAmt);
  document.getElementById('outTotalDeductions').innerText = formatMoney(totalDeductions);
  document.getElementById('outNet').innerText = '₹ ' + formatMoney(net);
  document.getElementById('outRounded').innerText = '₹ ' + formatMoney(Math.round(net*100)/100);

  document.getElementById('genDate').innerText = new Date().toLocaleString();
  document.getElementById('resHeader').innerText = (document.getElementById('staffName').value||'Teacher') + ' — ' + document.getElementById('month').value;
  document.getElementById('resultsCard').style.display = 'block';
}

function resetForm(){
  if(!confirm('Reset form to defaults?')) return;
  document.getElementById('staffName').value = '';
  document.getElementById('staffDesig').value = '';
  document.getElementById('totalDays').value = 30;
  document.getElementById('sundays').value = 4;
  document.getElementById('hoursPerDay').value = 7;
  document.getElementById('gross').value = 57000;
  document.getElementById('clDays').value = 2;
  document.getElementById('shortfall').value = 15;
  document.getElementById('epfAmount').value = 684;
  document.getElementById('esiAmount').value = 100;
  document.getElementById('profTaxAmt').value = 200;
  document.getElementById('resultsCard').style.display = 'none';
}

function printPayslip(){
  if(document.getElementById('resultsCard').style.display==='none'){
    alert('Please calculate first.'); return;
  }
  window.print();
}

// initialize
window.addEventListener('load',()=>{ renderStaffList(); compute(); });

</script>
</body>
</html>
